import React from "react"; 
import { Button } from "@mui/material"; 
import { jsPDF } from "jspdf";  
import autoTable from "jspdf-autotable";  // Importando o autoTable corretamente
import Papa from "papaparse";  

const ExportButtons = ({ metrics }) => {
  // Função para filtrar métricas válidas
  const filterValidMetrics = (metrics) => {
    return metrics.filter((metric) => metric.department && metric.department !== null && metric.name && metric.name !== "");
  };

  const handleExportPDF = () => {
    console.log("Exportar como PDF clicado");

    // Filtrando as métricas válidas
    const validMetrics = filterValidMetrics(metrics);

    // Criando um novo documento PDF
    const doc = new jsPDF();

    // Adicionando a logo em base64 (substitua pelo seu próprio base64)
    const logoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtIAAAC3CAYAAAA/zLlqAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH6AYWChUM/2XhRQAAQ7hJREFUeNrtnXmYFNXV/z+numdhd02MigqI+5JE44qaART3NWASY9QIo5IQpnsQ/fm+eW2TN28UZnoGiUYHRKOJUca44YbMgPsWExONiQoDKKImcWNYZ+k6vz96jEZZpqq7uqu7z+d5eEygb91T996q+723zj1HMAzDMAzDMELHD//esm1HmbObCLuJuLuhsrMq2yJsC2wHbAv0B8p7igwCHMAFVvX8XSewGvgA+ADlAxE+QPRtVWe5Kssrutzl1+09+gNrce+INYFhGIZhGEb+qH5nXl9Z2+dAFQ5wRQ4UZH/Q/XuEca74GHgF9BVRXhbl5b6Vff/cMPiI9dZDJqQNwzAMwzBCwfilLV8WdUaAHgkcAXwdKAuhqV2o/hGRZxV5KqpdT92w+5h/Wg+akDYMwzAMw8gJY3VuZFDbdl8V0dHAKcDhpF0wCpG/AfNAW+SjrR5vOvjgLhPShmEYhmEYRtaofvHFMnfr9mMRxonqacBWRXibHwH3Oap36sdbtZaiqDYhbRiGYRiGkQ1U5aJlC49yVc8DOR3YpoTu/kNV7sbRW2cPHf2kCWnDMAzDMAxji1zy5pNbd3V1jRXRHwH7W4vwBjAnot03F7tPtQlpwzAMwzAMH1y4eMHXIo4TVxjHpyHojE/pQJnrOFJ/49CRfzEhbRiGYRiGUeJUty0YoTiXASeZluo1T7vCNTcNGfkAImpC2jAMwzAMo4SY0NYyGuRq4CBrDd+8IsLPmoaMvKsYBLUJacMwDMMwjC0L6J8Dh1hrZI3nXeHnNw0dNc+EtGEYhmEYRpExfvmCvSXl1AMnWGsExkIVjc0eOvplE9KGYRiGYRgFzoUrHtlGuqJXisoPgYi1SOC4KL+N0D2l0KJ8mJA2DMMwDMMAUJUJSxdeBPyC4kygEnY+Qrhs1pCRswvFf9qEtGEYhmEYJU/14tZh6tAEjLTWyLs8fUocmdA0pOo1E9KGYRiGYRghZazOjQxats1lovIToNJaJDSsB676eOgHdc0yLmVC2jAMwzAMI0RcuLR1V1FuFTjaWiOkqD6Xcjlnzh6jl4bRPMd6yDAMwzCMUqN6aetYR3nJRHTIETksEpGXxi9t+V4ozbMeMgzDMAyjVIiteKbPmq51N6DyfWuNglPVN3U58qNbhlRtMCFtGIZhGIaRQy5YMn9wVKK/B75hrVGgUlp4yXW6z5q925hlJqQNwzAMwzBywIRlC8fg6u3ANtYaBc/7DvLtG4eNbM23IeYjbRiGYRhGUVO9tHU8rj5gIrpo2M5F509oWzgx34bYjrRhGIZhGMWJqlQvXXilwpXWGEXaxaLX7jzkqVhCEq4JacMwDMMwjCxw/rJFlWVu6jcgZ1lrFDcicmdFasN5M4ef2GFC2jAMwzAMIwOq35nXV9f3vRc41lqjZFhUtsE59fp9q9aYkDYMwzAMw/AjotsWDFKcB4EjrTVKDXmq0t1w0szhJ7abkDYMwzAMw/DAhSse2UY6o/MFOdhao2T5QzRaPuZXux71kQlpwzAMwzCMXjBp8UMDNzgVLViMaANeSHVVjJ6z14jVQVdk4e8MwzAMwyhoqt+Z13e9UzHPRLTRwyGRso5Hzn1vfj8T0oZhGIZhGJvg/GWLKnV9v/sEjrbWMD7DEZVrIr8f++rcchPShmEYhmEYn0dVylydDTraGsP4AiJjtu6z3a2oBubKbELaMAzDMIyCZMLSRVeDnmMtYWx6raVnT1i28KeBaXVrYsMwDMMwCo3xSxZWi+iN1hKe6ATeAVaCvgfyL1H5EMf90FX5EGSV4Lar0IHrrHMisra7K9W5UQHpRBxBB6GpAU7E2R5lmCpDgT0QDgL6h+vW5cJZw0bOMSFtGIZhGEaJi+jWkSLMB6LWGp8XdrJC0SWqtImwBGSJ66aWSkTemT109D9yYcNYnRvZavn2+6umjhSV40knxqnIc9N0OcLoG4eOesKEtGEYhmEYJUl124JdFOdFYPsSb4p1wEvAK8BfBPevnU70r7cMqfo4bIZOWvzQwPVOxUkC5wJjyJNrscJ70W4OvmHPUStNSBuGYRiGUVKcv2xRZZnrPkHphblT4G8gz6nygkTkhZ2W89dEVVV3od3IhLaWPRD5EcoF5MH9Q4VnV63/4JvN+47rNCFtGIZhGEbJMH5J6ywRxpeCcBZ4VZXH1NHHU6nyx28efvS/iqovl7Z8WdS5CvRCcuyiI8h1TcNG/siEtGEYhmEYJUH10taxqswt4lv8UEQWqKuPlEWcR64fUvVeKfTrRYtb9kk58qtcxwFXV06fPXzkfSakDcMwDMMoasYvXrSzOO7LwNZFdmttIL9H9b6Ph33wfLOMS5Vi/yY04axcetSlwE+B8hxV+36qLHXgnF2Oe8eEtGEYhmEYxSyyWoCqIrmlv6no70Uid88aUvVn6+FPqV7c+nUcuVfRwTmqcsGsoSPHIKImpA3DMAzDKD5x1bYwpmiykO9B4T2B37mue9tNw499yXp104xfvGhnx3EfVtgvR53z41m7j5ppQtowDMMwjOISVcvnD5FU9BWgXwGa3wHc46j++sNhHy4oVbcNP5y/bNFWZa77AHBkDqpbLbj7NQ079i0/hS2QuWEYhmEYoURS0RsKUES3AbMi2n3zDbuP+af1onduGVL1cXXbgpMU5wnggICrG6A4NwAn+hqj1l2GYRiGYYSN6iUt56nILQVirovygDr6y9lDRrVk4nNrfGYMpJPvPAPsFHRdCt+dPWzU70xIG4ZhGIZR0PR82n+D8GcvXAv6awe38cZhxy22nss+45ctOkxc90kC9qJQeM/tqthjzl4jVnsp51gXGYZhGIYRJspc/UnIRfQ/Qa6IRssHzxo2+ocmooNj9pCq5wR+HnQ9AjtEyjr+y0c5wzAMwzCMcDChrWUPkFfIXTxhL6xUqHP6rGtq2vGUddZbuSGxaFF05S7uU8ChAVfVkUrpPnP2GL20twVsR9owDMMwjNCgSF3YRLQgKwQmVrodw2YPG9VoIjrHQrqqqht0EhC073lFJCJ13saGYRiGYRhGCJiwpPUIhKdDI+qFD0SZ3r+8z7UNg49Ybz2UX8a3tf5W4LuB97vjHD57SNVzvfmthb8zDMMwDCMcCD8LiSWrFerdzoqk18NnRqALmytE+RYBf7EQ170KGNO7IWsYhmEYhpFnqpe0VKnIwjybkQKZHdGu/7EY0CEdJ22ttyl8L/g1nXtU07Bjn9rS72xH2jAMwyhNYrGhiBzkqUwy2WwNFwwqzk+Dd4HdLAtVNDZ76KiXrTdCPE7Qa0G+F/x4jPwMqNqy4DYMwzCMUqS2thrVGz0KaZs3A6C6bcEIxXkyT9W/iRKbtfuoe6wnCoPxS1ufEeXwoOsRRw5rGjLy+c39xqJ2GIZhGIaRV1RkSn6q1aZUV8X+JqILC3H5XU4GiKu1W/qNCWnDMAzDMPLGRW2PDkfllBxLsWUoI5qGjr7IDhMWHpEUd5MbP6Azf/BGy1AT0oZhGIZhhBIXpybHeuSBaLTsoFm7j3rGWr8wuWHPUStRfT4Xmj0SlRoT0oZhGIZhhI6Jry7qD3JujqpTUfmfWUNHnvqrXY/6yFq/wBHn0dyMGs479735/Tb1z1Hi8Rd7eal2RMZRX/9+6Bu3pmZvHOc2j6XuIZn8uY1MIzTE43cA3/D2YpEbqa+flkebfwOeDoA0kUxek0d7bwf28NjGc/PaxoZRRHT3cb+NMiAHVaVEuLhp2MjZ1upFgsMzuDmpaWDF2ug44OaNC2nofegf1XtIJEaRSHSGunEjkb6oegtppPpHG5VGyHgFONvjOD4byI/ImzRpIDAWb4HyzwGuyZO92/e0r7cvc+lA/YZhZAFVJuSgmg4V/d6soaPvshYvHiq7Nzy7walIAZGg6xIYvykh7dW1YwSrV99g3WcYOeEBH2W+xtSpO+bF2rKyE/CebWp/pkwZkhd7o9ETfbwD17N2basNTcPInPFLWw4ADgm4mm5XGDvbRHTRMXP4ie3A4hxVd8SExQv3zYaQBtULiMV+ZF1oGAGTTP4FWO554dzdfXyeLPZ36l711LxY6zgnei4j0kJT0zobnIaRBVz5fsA1qIpefNPQUfOssYuWJbmqSB39XnaEdHoyaaS29gTrP8MIGJGHfEwdJ+XczkQiCpzoq6zqKXmxV/U4H7bahGwYWZK4Inwr0CrgqtlDR99kjV3UtOWqIkcYh6pkR0hDBNXfcumlw60PDSPQyeZBH+L7WBKJ8pzauWbN0cDWPksfTU3NVjm1d9WqIwGvdSqqD9mgNIzMuWhJ62HArgG+O+fvPPTJn1lLF/scmTshrcrQCUtbD86WkAbYGtedl/MJ0DBKia6uVmCNx1IDWLNmRE7tdN1MdpXLEMmtO4qIn93zF2loWGmD0jCyIEocGRectuK9skjk/IQkXGvp4kZEPsjtwP3iuM0sjrTqnjjOnYwdG7HuNIwAmDmzA1jo49k8MceWnpzh2zDX7h1+3F/MrcMwsid2zwhMXDly/vVDqt6zVi4JVuVUuDucmV0hneY4dtnlGutLwwgM79E7cuknHYvtD+yesbCtri7Lib2TJ+8C7Ou5nOuakDaMLHDR4pZ9CMytQ38/a8jI+dbKpYGI5jS9uypDJ7S17JFtIQ2qtcTjE6xLDSMAXPcBQD2W2otLLx2WozdZNqJuDGLgwKNyYq/j+Nk9X0Fj419sMBpGFl5pDkG5cq0TNG4tXEKok48oSidkX0inuY5Y7BjrVcPIMo2N7wJ/8lyuuztXkXWyE74uMz9rL/hxe7nfx2LGMIyNr2YDejfJL5uGHfuWtW8JLcpISe7Fe3BCugyRu4jFhlrXGkbW8ZOcJXg/6cmTvwwcHCpBvjkSiUpEqrzPz2JuHYaRBarfmdcXNIivTx0SiTZaC5cW4jhO7iuVY85ftqgyCCENsB0idzNlSj/rXsPI5gpYH/DxsFdRXd03ULui0dOy+B4ZSiy2b6D2rl5dBXhtkzUMGPC4DULDyBx3beUhQEX2tY3+umm3o9+1Fi4xId3tOnmotrLc7T44KCENcCCuexuJhGNdbBhZoqHhj4DX0GuV9O8/MthZ0c3uLnJ2/K03tyDxcwhzPonEBhuEhpEFInJEINdNyY3WuCW4MBOR/NTsjAhSSAOcwerVV1oXG0b2JCDgJxlIcO4d1dV9fblJbF5IB+0n7f2Qk2UzNIzsPeIqRwZw2bam4aP+ZK1bghOjo3kJv+zCEUELaVD9CbW137FuNoysPVMP+ih1cmD29Os3Bu9uElu6x0O59NIdArG3pmZvwGskExfXfcQGn2Fk5fkW4LAAdhmarXFLdGEmTt+81AsjEpr2vHACrUf1Jmprv2FdbRhZYO3aBYDXUD+DA/M7DsYNw6G7O5gY2I7j57rPMmPGP2zwGUbmXNj22DBgm+y/i/Qha90SFdIpt0+eqt76rcUjdgtaSAP0wXXvDmyHqVSori7j8su3Jhbbxg5yljBNTetQ9X7ozZ+A3DzpbKbBuI0E595xog9bHsh7v3/y7F9++db2EBiFjCN6YACXTXX0TZlbR8kq6fzsSANEHQ4AiAZ/k7IzqdQ9JBJVdmBnC8RiOwHHIHIYsAfpbHG7AlE6O0EEXBficQVWAIsReR3VZ4lGH2PatLetEYv9pSHz+Fww+C2SThc+Lat27LTTYcCXArrLY4nF+tDQsD5rV5w0aSAwwnO5XGUznDp1R7q6RiByaM+zPwzYDejz72e/sxPicYD1wHJElgBvoPo8rvtUT7zx0mDSpAqi0QMR2QHYBpGtUS0H2hH5B677Og0Nr9oLI2SvL3T/7Adj11du22HMWmvdUh1U2jd/Ef6d/YF7ozmq7TBWrWoCvm+9/jni8T2A7wJnA3v1+n0EuwC7oDoKmEh3N8TjfwNuR/V3NDQsDcDWk4EZHkXcsYHYApBIRGlvfxEYsIVfduI4B1NXF8zLdsqUIbhui8dSk0kmve92plIPEvF8tuJIamq2orHx4+y9P5wgo2v0RWQU/mJnb5zy8uNQ9ZqCfGmgYiwePxA4G9Vv0d09nN4fPu8D7I3q3p/pD4jH30D1LiKRO6mreznHwnZ7ysoe9vhuiNHQ8KSHjYZDEDmb9CGfr/HZEGqq/Mf/FnkH2KlA54TvAYme97yfxfajvPXWj2huToXt1pT0Dl6WldSfTUiUMK70RfKjpFV0f8jFjvSnD/e51Nb+lfr6adbzCLHYGESmAtmMerAP8L+I/Ix4fB5wDcnkM1m7elnZk3R17YS3GKBnAdMDacVVq0Yi0rtPha57MnBnMA+yexbgJRFRB677lK+6Zsx4i1jsZUS8TEhRRI4D5mbxroNOnnJqVoW0H7eOIKJ1JBLlrF59NhBH9as978ZsXX0PRK7Ada8gHn8JSLJmzZ00NXUF/kbr06eM7u6DPJbaaou/qK7uy4ABF6E6vuf9VuwbK1NIfz3yK6LnMmDA5DCK6B72y/pkqvKOSYpS1tG6teSrck2P59zGelb9Rc+uZulSWzuCePxFRB7Osoj+T6GeFiJPE4/PZ/LkPbNy1WuuWQUs8FjqrAAXZ2d7+PXZAfaq13tckNHusJ8se46TPX/m9FeUvTyW8urDeLJvMbGx50H1hJy086YFtEM8/gPa25eieuu/RXRwfA24jX79lhKLXVBwcf0TCYdY7AL69Xsd1WQJiGghHq/v2XTwK6JvYMCA75BIdIayS9MRDnbNvpbR90xOli4ibJvHp3YIquLn5dqdQbUO8NvAs5eFkVhsG+LxX6P6BPD1HNZ8HJHIy8RiP6e6uiwL12v2OMoPYfLkXQKYaMuB0z2UOKHHTza7TJ26M3BooG34Rbzv1Koen0Ux5XU3+l1EfuaxzFeIxb6RpWfvIMDrgedVrFnzRFbqnzLlUNrbXwBuItfuBiI7IzKH9vbnicUOKZDNhl1pb38SkTmI7Fz0c0MiUU48fhsQz+AqP6e+/hISCTest/lm2+E7AeXZv7L+y+RkCaOyTR5rr6x+88kd/Eysj5LZJ9eBiNzHD3+4bcl0dE3NkYi8RNpHPB9fIcoRuYL+/Z+gpma3jK5UVnYf0OFpzRaNZn9Xur19NN7CKFVSVpZ9d4Tu7jM99mknrnt/RnUOHPgC8E+Ppb7MqlUH50lIP8Dq1Y+SPiTnYdntZCt6h5/d+EcydokYOzZCLPY/PW48B+X3JcTBiDxNPP5fPRFXwiqiz0T1z3wm2UFRM3Fif9rb5wHn+JURQIxk8r/DfqsRJ7JbENdVJ6PNPaPgdTR51ZLS1bmbdyEtkiIa/S6qmRxmGUZFRXOWdkjDTTx+CY7zGOnDgfnmMBznj8Tj/icpP+4dqkG4d5ydozJbwuu9PZrxob/0rtNDPp7dzN07amu38yxyVOfR1LQOaPVULnvpx/2EvcvMrePyy7dm551bELmKXJ5F2TxR4H/ZeedHQxlKr7Z2EqrN9MZ3uhiYMuVLVFYuAo7zu4wHzieZbCyE2xUkECEtbmieLyMf40o1r0LadRjq71PvtGmre07tZ5KooIoBA64tchF9JXB9iCZSSO/iLqC29oQMruHVNeHwntB+2WHSpArgNB8lj6OmJnuT9OTJXwa8pbtVvStLtfv5KpS5kHbdkwAvO5rrgBZf4lTkgIy/oEyZ8iVEvLqIdOO6D/uus6ZmNzo7n0bkm+GceWQknZ1PUVu7a2hsisX+G9VryfW5nfzd71Bc92nA71ei9cBZJJO3Fsw9KzsGclnHhHSJs2Neh7U6O/p/adXXv0naR3VDBhZcTCw2sSi7trb2Z6RDGIWRvqjeSzzu77Cjd/cOBzgja9ZHo8cDg3yULEcke3ZEIqd7FJWdqN6Xlbq7uhYAXg8VHdQj/jPB6y5xy7/jQbvug+Ax4mckkpl7h+se70OcPU1Dw4e+RbTIk8DeIX9D7YPrhkNMx2IX+/ChL1zi8a8h8jTpPAF+WIXqCSST9xfUfSvbBXTlQRglyVidGwG+nE8bRNgus9V/MvkcIj/wPDn+pxWNTJkyssh2GyaiGnaftXLgbl8HP/24d4h8K4sjd1xeyn4Rb24dqguyFst55sx2wGuWQwfHOd53nYlEZU8YPS/t/ekudEPDSrxG71DN1E86d2Hvamq+guMsKJgDciI747oLsrC4ymTD4QREfllCInoU8BjeD79+wj+BKhoaHi+4e5dghLSoDDZJWZps+8a2O5D/L/7bZv4Zrb7+d8BPM7hCGa7bTCy2e1H07JQpIxGZmcUrrgQW9bgE3ATc0yOgVmbh2lshMs9nNAuv7h0jsjJhx2J9gEzE1ageP9/MSB+W/WbAbbYlvLt3ZBIGr719JNDfQwkXx/m8jV5F6jFcdpm/HadEIgqM8SEwvQvpSZMqcJz78b/LuDE6gBWoPo9IC6rPk85omr0MsSLDcZz7eqLg5F7Iq96Kt686hSyizyZ9tsFv9KDlRCIjSCZfKsTbVwI7FLYLRknSVRaGpEu6bXaUfDJ5FfH4Xvg/zLUNIvcxadLhPTtthcmkSdvjur8hMz8/7dmxuJVUaiEzZry1yV+mPyMfg8gFwDE+6xtCefm1wPnelj9l99HV1UHvk7NEcJwzgBsynHxPZMuZDDe/cIMzgaaM7CgvP7XnWr0le24d/x4p+gAiXjNNHkd1dZnPiBSneqzrD0yf/p8xXl13Ho6T8NLSdHUdj59kOqtXH4H3g2uvkUy+4WM8JFHNRlSUPyDyMKnUI6xc+cJGE2uMHRth8OBv9CwSjicdflEyeKYOpb19OjA5x2/MX1Aqn+Xj8R8DDRnMDX9D9TimT19ZqE0g3qIseWEoRkniuOyE5N2MbbN1sENRvaBnx8Qv+1BW9rtQh2basri8EfiK7zYUuYNIZDjJ5EiSyVs2K6IBGhuX09Dwa5LJb6J6APCIT0F2HrW1p3sqky/3jmy4Zqhmw70jf24dn5BOvf43j6W2ol8/P1FbBK9fAja2s9vY+BKqb3us+xSf/ZybaB21taejmulZj4eAw0kmD6G+/koaG5/dZHa65uYUyeRzJJNXkUwejur+wC1AJtnsfpyHZFnZEtHrgY+AD3v+G6ZYykIs9gtghm8Rrfo8HR1H97hGFSwi9A3o0geOfXVuOUYJKmmG5dsERftk74R0Q8N6otHTgbcyuMqJDB58dUF2aG3tGPweqFNdjMjR1Nd/h+nT23y2/yskkycA5wHtPmyo8/F516urwjEZuVVMmdIP1WxM9t/MyM3ksssGITLa4yxyV0Ajz7t7h58weLW1B+P1dLTjzNvoe+eL7h5b4oQeNw2vnOS5hOt6E9ITJ/bviTbhl78gcgjJ5Ekkk8/5fPZfJZm8AMf5OvBiBrbMpLo6KLGTLf4CNCIyFsfZnzVr+pFM9iWZ3IZkctue/0ZYs2Z43i1NJKLU1t6MyOUZXGUBHR2jue66Dwpd86gSlNit3KZy+wNMVZYgKnl3CRakIruhhtKfcU8F1mRwlSnEYucVVGemJ/kZPkvPp6LiUOrrn8qKLcnkrT0iz2vUgWGsXn2JpxLeo3dE8ZaN8PMi52TIyq5GhEjE/+54d/fJ9N6lBaCT8vL7gnmRaK7C4HmN1rGcurqXN2Gz113fbVizZoSnEulsmvt5XGB8wNtvP+NtCq/8CeDvsJPI9QwceAj19X/Iylioq3uZgQMPR7XB5xV2o1+//wrhG3Y1UIfr7kMy+VWSyRj19XdRV/fXnvjkX2RTf58rpkzpR3v7fahmMpc1M3DgyVx//RqKg8DyRqQkdShG6eloNAxn6yqyH7MzmfwLqt8lk89rIjdSU3N4wfTm6tVjUd3Tx33OZcWKk7j66o+yak96Yh4JrPUoyq7oidHcO/wlZ8nEvSObCVX8u3d4TzDTkvU+/oRBg571sWjaz3PYM+/JUTYtlgcOXOh5bKZS3uqPRPzsRj+0SXeKjYulLwE/8tlzl1Jf/0MSic6sjodEopuGhjiqk/ATTUlkclYO42YHF7gW1d1IJi+lsfHvBTEf1NZuRyrVSmZx229kxYrvZH185FlwBHVhUTkeo+SQ7B7u9kt5MMHvGxrmoTo1owfOce4mHi+MsDaql/qYsJ5lwIDzPE3cXhc0IjUeS32JsrKxnndNvDHSV1a1qVMHACdksYVG+EoSM2VKP7xHgmgObOwlEt3Awz7GbO8n+fSh1gM8ju95m7F5A9796736SQfvH+26Nfj7QnIFyWRdoO+khoZfAn7ewf3I/aHDjfEOrns0yeRk3zG98yOid0X1SUT875Cq/h/J5CWBzQ35I8gwZaMnvrqoP0bJcP6yRZX4/RqY5XEdXBaphoZ60uHa/LIDcF/offZqa0cAX/NY6iO6u8/oERTBUV8/G68+tCLeDk15d+8oo7PTe1bC9I5kZRZbx0FkrOdSrnuiR/EUnFvHpxNvsO4d6SymXmhnwIAtxbn16t6xO7W1+/RycVFJ+osMnvqpq2u+hwVMJXCxj3b/HcnkL3Lybkom61C9zcd4mujpy1T2+QvR6DdobHy6oGb2KVMOQPUZYC+/TzJQS0PDf5FJbobw0hXgtSs7K/U4jJKhvNvdh1BkQpWuYI1Ys+YSVB/L4Apfo1+/X0MIApxsmu94b3e5ihkz/pGbPhZvMb5VD/cU09uPe4fXiBdpzg6gbcb5KHOmxxLBuXV8QkXFfKDbY6mRPWKwN5zqsY0e2eIn6VTqQby6f/U2Ocvq1VV43yl+3FPozfb2UwCvX1beoazsEnJJd/ePSMee9sI2lJefRD4QeR3HOY5p094pqFk9FjsG130c/+mKu1G9gGQyWazCR7xtuPjYGdFzTF6WDq7IfuGwRDuCFdLpWLVnobo4gxfrt4jH/yeUPZlIRFEd6/F+Xmf16utzZmN9/R9QXejtjeR4nUS9ui4c6ynJRk3NVmgAuw2qh3nyFU4kKlENum28c/XVH6Hq9bBq3x7BueW2h6M9tuuWd5vTC8kXPNp8ai/rz0XYu+/5qGNKz8Izd6QXB7XeZyk3H6KkHdc9mbq6fxbUjB6Pn4XII3iPWf4JG1D9Fg0Nvy5m4aPQGfD1T7349dadMEoCQfcPiSkdwW+LNzR8iOueQjq+p1+upLb2W6HryTVrDgK29zhBzfKZDCMTbvcohLwJEe/uHRV0dfXe59VxTieYgyqC6/Z+V7q9/Ti8JYMJ3q3jU7y7d/SmnyORE/B22r6bjo7e+Wx7F6+H9Rzw2xLehXQq1Xtb0mEiR3us4VUGDLiTfJBM3oXqyx5FfzpxT05nRrmYhoYlBSaiLyGdLMiv21k7jnMCDQ33UfwEfXAy6kbkByYxS4XQCOnO3PiXzJjxOjAW/z5SguotxONfC1U/uu5RnhfNInNzbqfjtHgscbSnuL1Bu3d4S6DS1vOnt5P3uEBsTtvdGrhbx6djMSg/aa/+0c/0Ouat15jN4JBKbf6LQE3N3njPdPYKjY3Le/3rVasOxbvryHUkEvlKFKKIeP0K1p/+/b+RQxHdQn397wpi/o7Fbuz50wxcj/8U5//Edauoq3usNHQPgYfxU9GLeg6hGcWOEJbY4WuiOasqmWyltvZHqN7o8wr9gPuYPPkbOfMv3jIjPP5+BXAY8fhhuX2BKaS/CPTWp7OSVav2BF71UEsz4CVZyhgmTuy/xRipP/zhth6Tn8xFVRG5ope/P5hLLx22xUQ4iUR5j18sHtskN8yY8Tqx2GJEvCSiGEpt7V7U17+2mXs+weNYu7/Xv21oeIV4fDmwmwfBdSpw82b+/UQfz4c3QS9ytMcaOnHd/IpE170Tx7kWPCXFOAZ4JhdvKERqKRREqrNwlTeB42hsfIMSQYQPcnCCcqfylFYD12IULRcsmT8Y5CshMef9aE6rq69vIh7fG6jxeYXBRKP3MGlSFTNndoSgAff1+PtdgLkFMlYP9CSku7rupaxsA73/xNmHioqTgTs2+6uKijPx4lrgOHf0CIcrel0mlRoHbD6SwurVo/B2uKwLyPXn2geAmEcReSLw2ibu+Ri8pnH27q7xAN5iMR9HdXXfTSbcEPF+SC4Sud/jPe7XszjtLc9lPT28VxobPyYefx7w8hVt3xxZ9/Amk/cUJ38HxpBMriihe0aVD3IRNsAV/X/V78yb3bTjKeswipKIEzk0RHFtPsh96JAVK6ag+mAGT+PhlJffmPemS7s+7FrEY9Wb/1H6UJNXF5LeuEp4Ocz5GnV1L/dMyl6SN5zdi3F3psdx2pLz+LeRiB8/6ZM282/eduBFXieZfMNj/V6Fd18GDtz4IclJkwbi/SvRP+jf/w8ebd7DYx1PhuKJFnncY4k9c2KX6swS0gAv0NFxVKmJaAAVcpLmXGAH1vX5EUbRIup8Izy2yIe5F9LNzSnKyr4DvJLBi/c84vEpeW29Vat2IcCUpyGYdHfw07se6zhhs3HCJ03aHqjycL3P7vZ72fk/kNravbawaDot0LbIBu3tTwKrPPbBiB4BujFO9fhczvNs86BBjwHtnsqkDy9/kbKyY308kw/68F0e5rFd/haKZ9p1/x7offrjfQYNaqEUEGlhw4ZRvT5DUGQ4ou/nTrTLf1Uvf+IrGEX6LHFIiGx5Pz/BrKdNW92TqSwTX+ericdPzN9bwdm6qAeq6vaey3iP3tGP/v037YMbjZ6Ft2xYd35GNNzp8X43vSu9Zs3ReIvOkg+3jnS4SZH5HkuVU17+RR/0ePxAvH5x8eIf/ekipRPVRz2WOoWNx5YPPuxdIuEAAz2ViUTaQvFMe7djEMHH8L+vJztncaN6F52dJ2/xTEgxNwFOLnfhB6rbebUpzuKj+sUXy1A9OCz2uOKuyF9WmPr6N3HdMwC/2f0iwO09p/Tz0HpucacjFfmS5zLXXLMKkUc91rO5sIZekrC8Qn39pzt/jY1/9xjya9xmJkGvCWRa85jWOFth8LwmYfmAt99+xudY87qTvSOx2EFf2BfwLqQ3IOIt2sy6df08i8uuro9DIua8xrB2mDixX8DvmdYSmPsf4O23vx2Scz35Exzo8tyOdzm3um3BCIziGkfbrj4ICI3+clKyNL/pFRsbn0X1QvynQx2E49xPLLZN7lvP6Vvk49XfBKp6l8ffn7TRDHs1NV9B5CgP15m7kT7ysiu9D7HYF/3CEwkH1TM8tkJzHvvtYSDlscyJGxGH3oS06z5Ec3PKl8UiD3m2OR2941Nqa78OeHVHWkhd3VpPJTo6vD/3kUg4Dj2prvVcpqwsWCEdiTxO8TOaXXY5gxKnzO1enuMqxUUaEppwMIoGcd1jwmRPqrJref4HWEPD7cD/ZnCF3RG5pydJQg6XRW5XkY9Xf6Koq+tevH1lGMCqVWM2MsF+Cy/xWaPROzfSR3d4WqQ5zhd3pVevPgLw4mvXheq9eeu1+vr3gec8lvoK8fhX//3/YrGdgIM8Lizvz9DmZz0K6VM+19d+Ulp7t1nE+66iakVInuk+Pt5z6wO05x8FlwrcH5WozqW2dmopC6Abdh/zT2BtLusU5OC3l424xORnUREmId1+0+DjPwzHSi2ZvDLDRCVH096ezO2ySIrd181f8oiZM9s9fy7fWPQOb0lY/sT06Ys3skhbCvzRg2g4eyN/d6bHe8mnW8cnYzPT6B2b8kHeFJ1EIvMztHmeR3u/+rn07l7dOhRV7+201VZrfLTtwFA80SIDPLfRe+8FJ3xU/07pIKheQ21tHeQiCFxoyfl5AVH5P0sdXhwkFi2KAkeGyKQlAGH55KG47vnACxlc44fEYhfnzGLH8SOk3wKWFsQfkbcymCC9uXeInPofXxSmTt0ZOMLDFTa3CLvTgx3Dqan5+n9uaIhXId2c96fJj5B2nM8KUa/ZDB9j2rTVGdnsJUX3p4uc9K70pEnbI+I1HNKfaGhY6f1NnugGvLlqRCK7heQ96zVc51rf7jq9G6eLS04JqNZSW3s7kyZVUJLIK3modKAbtQQtxcDKwe4heD3sHSwvg7eICMHS0LCemprTcZzngcE+X8zXMmXKa6iuDtzeSGQFrsdNW9f9Lo2NTxf9aC8ru4+urg6gt5PFINasORZ4sEdUjfWwyFMcZ+5mBNpcIpFp9HYXKO3e8ScAamsPRtWL+MivW8cn1NX91XPGQNVDqK3djkikg+7ukR7FwbyMbW5s/Dvx+BJgdw/P+ynALykrO8HHpkAmNi/DS7IS1T1D8mTu5eM+g+S9klQDqt+mrOzL1NScmfdEPbm/+VfyUiucWb2k5fSm3Uffi1G4OJwQokQs/x7P4XLCb2x8F9c9FfDrNlGG6l2oDg3c1muuWQX8y9sgcA4ticHuJ3rHZyNjeHHrUH2BurpNT/gzZryFN//bcf8W3d6jdSzMu1vHp3jdlY6gejzd3cd5WAB9Mq7nZcVi74L8mz0xsL2HvXPdTGz2mtb5iFCMCNUjA75Pr/YUqpBuBppRfT6Da1ThOE/0fH0rHR2k+pe8DX+RX17y5pNbYxTwOowTw2SOiPw1fEI6Lab/DJyDXx9d1W2BXGU+XOyx1Q8toSHf7LHfTqO6uqzH7/VQD23aG996L9E7hjBlyifB3s/yeA/NIXrCH/BR6kRUvSae+Qv19W9myWav4rac8vKTgOM89tPbNDa+lIEA9Orbe3TOD0N/nrQrwVEe++PvAY/RdgqRZHIcyeQ43n77SFSbMrjS/nR3P8OUKfuVyqTQVe7mMxX8Tt3dXaWURbOomLhs0Q7A18JkU1Scl8MppNMvqvtRvTyDK+Rq1ektOoLqcZvN5FdMRKP34y05yzb061eF6366I7xlXKLRub2w5S5PCzPXHdeTkGR3D/Z30dl5b2jav7PzMbx/2RnzOV/pIMTvplmz5ingY09lXPcqz8+74zwAGXwgdJynPJYYSHv7KXkdD2VlJwMDPLZt0KnNCzuucnNzioaGixD5aQZXGYzrPsmUKd8shWlhzi7HvQO8nT8L9JzxbQvPxCg4Ol33BMJ1UPet64dUvRdeIQ3Q0DAdmBPqnlX1OqFuRf/+40pi1PtNziLipX2eYdq0Lb+Up017B9UnPFx37BYSxWyMhaFK/ZtO/uA1eso2PV90vIit7AnppqYu0nGwvYyZ4T6e28xsjkSeArxm47sozyPCa/2dRCJBn+cojgQl9fVXonoJfkOGwla47iPE42dTAohIXs8JCXrj+KUtXzZpWmDjRjk9VPIP/q3/wh2ofODAS4DwBux3nCd9vDxzP6EmEg6x2IXU1HydsWMjOazZq6vDt4Hep/5U9eKy4eW3g1Gd7FGcNYdwhD4Q8PXfpaHhD1lenAZt81oGDlyY0RXSEUqe9VjqWOLx/PhKp+s91mOppz0nq/He10qx0NBwQ88mgN9MvRXA7cTj8WIXROpqvg/cbydwI6qlHIawoJj46qL+iEcXvuCV/TOFIaQTiU5Uz0Q1nGGS0okkvE7Kh1Fb+62c2tnefj4is3GcPzJ48Cri8aeIx68mFjuFyy4bFFi9nZ334TU5S+9xKSu728Oi5y687SJ6sSVcbh2f3vMD+D1r0DshNA+yfIa6vPxBIMhkR4+SSGzIwr3f7v3FK9eRSOQ2UlIi4SBS58PW2zG8zgd3A1WI+P0y5QD1xOMzSBRvNj5R8h+5SuW08ctaJ9qgLQw6K1InAZVhsimCUyA70umV/oc4zqnARyG18A4fk3AjU6cOyIl1NTVbAT//zN/0Ix3Q/DJE7qer633i8eeJxZLEYmcweXL2Pnn5S87SWx73lBXN36Knt4TLreMT6ur+CbwYYA3Z3z2+5ppVaKA7VtmyeS5eXRNUv0p7+2U5XkRfhurhHkttIJW6C8M7yeRzuG4VkEnGxh/T3n5Hscaa3vFt52W8noUIRNBL3filLQfYoC2AxRcSNr/2Dz8c8v5fC0dIp0XQaz0h0cKXlrur6y5glcdSO9Hd/UuCd5wXHOdmYIfN/CYKHIJIDJG7iURWEo8PzqINQbk83Om5hOrcYFpZwiw6gnKVWAe0BNSe8wKy2SWVejBrC3z4nY+SVxGP5yaEU23tGOBnPkreXnrxjbNIQ8MriBwBvJbBVcZSVvYol19edOHaElVV3YG9O7xRKa7cce578/vZoA0v1e/M64uELuzdgmYZlyosIZ1+ObUAk0Jn18yZ7cAsHyW/Tzx+VaC2xeNXgGcH/XkkkyuyZoP36B29oZuurrs9l6qouBvozPZSig0b7ilBId1CQ8P6QK4ciQQlpF9gxox/ZO1qqdTVeHediQDNTJkyMtBer60dgerve+rzdFdEIlfb9J0h9fVvInJUhrGmj6az88ksb2yEAhV9JByKiL0r10Z/aQM2vLjr+54G9A/V+HX/c/wWlh9WMnkjqjNCZ1c0OsOnWPwJsdilAYno/wf8r4+S12TVDj/RO7bMQmbO/JfnUldf/RGq2XY1WRRKt45Pn5k/o5r9cFPB7RrD9OmLyWw3Lzc2z5jxei/jmH+evrjug9TWnhvQsz8W1fmk3bi88rue9jcyF9PvE4mMAh7K4Cr7As8yZUpRuSA4TvlDEJocdedXL2m5yAZsOBE4N2QmqUTL5heukAZ4++3aDF9M2Scdgi3pc3KfRjz+m6zFl544sT/x+Gzg/3yUfoBk8rkAWijb7h13+i7pOHdm9ymX5pA/MYrIg1m+pttzkDHAt2cAQj2bofo+IRK5FH+ZWCtRvZXa2lt6zjFk69m/vuf58PM+aScavQwje9TVrWXNmtMR+XUGV9kJ130i8K8YOaRpt6PfBV4Oiz0qMuPCpa2H2IANFz1hCo8NmVkv9YzfAhbSzc0purq+A/w1VHZt2PB/wEqfpc+hf/8XiMX8J21IJBzi8bFUVr4EXOjjCp247tRA2ia77h2dlJf7d6XwHklkc3QD9xbAU5Nd0av6B6ZPDza9c/ZF73IaGl4JZBGtmsigLc/DcRZTWzvZ92J60qQK4vEJVFa+DlyC37MXIv/j6QCv0UvV2NRFff0FZPa1bxCu+zCx2HeLpl2UMJ0tqYio3HXB4ie2twEbpjEi3yF9jis0yEY2BgszxM7Mme247inAP0Nj0/XXr8FxLsL/56p9EbmfePxZamu/Qyy2Ta9KXXrpcGprp9Le/lfSkQR29zc6ZBqNjcGkBM6me4fqAq6++qOMxo7XpB+bZmFPNJCQv4y0lfThwCy9SQJ06/iEt99+JoMwYhtjXoC2NqKaSUSY7VBtpH//t4nHryceP5WJE/tvYeFcSW3tsdTW1lFW9ibQBOyYgQ0LGDDA0icHKRuTycsRqcF/SMpyRH4TmDtgzhVJQIe/fXeQDo46XXdWv/himQ3X0IjW80NnlPtFIR0t2BZubFxOPH4G0EpY4gvW1T1IPD4T+HEGVzkM1cMQSRGPPw/8HZF3exYNDq47AJFtgb2BfUilsnEQ5U8MGPCzgFunGcg8TXJ2XDPuBM7IwnUKI0RYQ8N64vGFwMlZuZ7jBC+km5tTxGIPIZId/7ggxX9zc4pLLz2HVOpPwFcyuNLWpHeUL6GyspN4/M/Au6RDqbUD/VH9MiI70N5+ENAnS3ewEsf5HomEixEs9fUziMX+0ePqUe5LW6TdAQczcGBNIffZrGGj35jQ1vJnkK+GyKwq3frjG/D3VdfIItXLFh6qrh4YMrP+0DR8VNsXpsSCbulk8hlExhOeQwvQ1TWVz6SOzIAIcARwIar/jeq1qDYi8jOgBhgDZENEfwx8h0SiM9B2yY57x4Ye14xMheADQKZZ27oRuaeAnpZsuXcsp64uN76N2RO/7QwYEGyG1OnT38NxzsCfv/TGKAcOAU7rEdeXAT/sSV0/IosiejUiZ/TEHDdys7C9A9WTgNUZXGUS7e1zSSQqC7kpBLkzhFb9YHxba40N1Dzj6kUhHLAb/YpS+NmT6ut/i8jPQ2PPzJkdlJWdjOrLBdB6XYiMI5l8I/CasuPe8XCPa0ZmpFMfZyosC8Ot49OFTLayEN6fw0XpfLITrvDhwBeK6XH1PI5zGtnzwQ+aTkTGUl//B4xci+kWVI8ks8QtZ9Hevoja2u0KViu5zm+AVPj0EvUXLm09xQZqfqhuWzBIYVzIzOpORVO3F6eQTovp/yG4xB9+RePJiLwe4lbrBs6hvn5BDuvMrI+ymVBFNdOdkMLK/JY+RPbnzGcYeSBnNqcXTY9nweYHc2ZzXd1CRM4kezvTQbEG1dOor59v03bexPQrRCJHA20ZXOUwVJ+gtnbXQmyC2cOr3iZ7Z1ayieMov61e3Pp1G6j5WMk45+IvfGeANumDc3Y57p3iFdKgqJ4HhGdnJZlcQWfnUQSbotkvGxA5m2Qyt4uPzNw71tHRkT0RN2jQw6T9Tv0tQgrLreMTQZmpq0TwLhJfJNM+T7FhQ27DZdbXP4zIN4H3QjoS3gWOpqHhEYz8Mn16G6nUkcCfMrjK3qg+Q03NVwty8nZldkhNG6AOj0xoa9nDBmouB4SKukwM3fSpziYT7zlF0/gNDetx3dMCST7hl5kz/4XjfBPV20I1iTrON6mvvzvnNWfm3vEg11+fvV2+RGIDqn79rRcVlFtHtkSpyCM5cZH4jzdUxgcbn85Lwpz6+j8SjR6ESEvIxsACXPcgksmXbMYOCTNm/INo9JsZjpUdcZzHicVGF9rt7/y2PIgS1rCL24vIwxOXLdrBBmpuuHDZwpMR9g6ZWSs/Gvr+I8UvpAEaG99F5FQyP0iWPerq1tLQ8H1Ux+N/BzRLSyqZR1fXgdTVPZ9HK/zugmf/UEokcmeO7yG/DBjwRzLZJVWdl4fnZxmZxYyfl7f2njbtHQYMGANcGoJ30lqglmRyDI2N79p0HTKmTVvNgAEnIXJHBlcZiEhwGTMDIlFV1S3IDWG1T5WhXa77wA9ee2qADdTgcZSa0I0B0eubZVyqNIQ00LPTMo6wHWBoaLgJ192rZ3c611FG3gHOo77+NF+ptbOJv4Qoq1HN/uf59vZHgQ89luqmq+vegnw20qGy/PoLp+joyJcvYyZi+P68t3kyWUc0ugeqTfiPIex7DgCaEdmXZDJJmCIcGZ8fK53U138XkekZXKUc1V8TjycK6dZTFZ3XEaYNsC9yUKSs45GJry7qbwM1OMYvbTkAqAqZWWsrOrhxs+K/KHsjmXwIkStCZ1dj47s0NHwfkUOBe3Iwqa5A5Meo7k4yeWsoJtGZM9sR8XrAcR4NDeuzbktTU1dPP/QekcfyvhjJBP+HBfPjIgGZZDl8IycRaXrDtGnv0NBwEY7ztZ7FdFfANXYBt6J6IMnkOOrr37RpuiBQ6uunApdn8L4W4Epqa69j7NhIIdz0TYOP/1Dh1pCbeURXpd5z/rJFlTZMg8FRuRS/mVkDmzOZc93eoz8oPSENUF8/DZGbQ2rbH0gmz0RkX1SvBt7K4tXXk05bfRoDBw6lvn5mICI0M7y6RgQXa1Q8xzFtLujnYv36Fvwc+FTN387uVls9j58sprnIwOiVurqXe1y9hqA6Ffhjlmt4EdWpqA4hmTwvkLToRvAkk9egekFGCy7ViQwefBexWJ9CuGU3pXWEMBTe5xp1dJnr3jdp8UMVNkizyw/eaBmq8O2QmZWSFDO29KMoIgd7G+3uqoLpmdWrL2LAgOt6Oenm/vBYff1rwP8DriAW+wYiVageg8hBwJd6eZWPgFcReRbXfZK1a1tpaloX6n7p7JxLNPp0r38/aNBbgdny1lsL2XnnYb3+fVfXyoJ+W6UPbBbWjkraJeXLRTVrNDSsBKYD05kyZQiuewxwDHAoMIzeZb3rBNoQeQ7XfRzVx2lsXJ6X++nq+ggRb3Ffy8r+mPd+6Oy8g2i0JaRj5NdMnvwIjpNZGLCOjoLYlZ6zx+ilE9pamwmfmPo8x21wKu4Y++rcs5v3HdeJkRUijlxO2LJtK7dvLJPhF+SjdV9IueyyQXR2Dge2Q2QAqgOB9Yh8DHyMyMd0d3/AjBn/sMYyjCJi7NgIO+00mGh0N1x3IKp9cZyBuG47IutQXYXqm6xcuYLm5pQ1mFEspEPNyauhE1Qb5+H+5X3Oahh8xHrrucwYv3jRzuK4bb3cQMgVqZTIvnOGjtxiPhAT0oZhGIZhhENML235NSrfLwRbFVo7+nWfdtsOY9Zaz2XS563XokwKWe/OmTVs9IW9+aVjXWgYhmEYRhiQlPyU4A/jZsdWGFW5NvrwpMUPDbSe88cFS+YPRpkQMrM6I07kZ739sQlpwzAMwzBCQdPwUW0INxSQyUd1OBVPX/x6607We96JStmVhO7cjvzyhiFVy01IG4ZhGIZReOIqUn4lUDDZYxX2S0XlSUsn7o10e+l5ITPrX12O/MxLARPShmEYhmGEhl/tetRHKD8tLKt1iIo8c9HilsOtB3uL/JyQHSxVlf++ZUjVxyakDcMwDMMoWHZa4fwK+FtByUJlW9eRRycsXXiq9eDmuaht0cHAWSEz6y+rhr1/k9dCJqQNwzAMwwgViaqqbsfV8QSfATjb9Ef13uq21oT14qZxcZOEK3KcizKxWcZ5Dilq4e8MwzAMwwgl49tarxe4pBBtF7j5ow0fXGyJW/6TCUsXjkP1zpCZNWPWsFE1fgrajrRhGIZhGKGkj9txOVCQGWUVLtiqctuWicsW7WA9meb8ZYsqUa4OmVlvpboqfuK3sAlpwzAMwzBCyczhJ7a7Upg70j0c1ZVy/zhhSesR1ptQ5moMdEio1jvKxXP2GrHahLRhGIZhGEXHTUNHzQO5sWBvQNgR4fEJba2XlXI/Xrxs0W6gV4TKKOW6WbuPejiTS5iQNgzDMAwj3Fq0z9o48FoB30IUuHp8W+tvf/DaUwNKrgNVJeXqLKB/iKx6tX9Fn6mZXsSEtGEYhmEYoaZpx1PWqcr3gII+uCfw3UhZx596wr+VDBOWLroAdHSITNqgot9tGHzEehPShmEYhmEUPbN3H/lHUbm0CG5ldxf36eqlLbWoFn30tOpli/YCbQyZWbHZQ0e/nKXFkWEYhmEYRmEwvq31twLfLYqbUZ0fScmFN+w5amUx9tW5783vV7k2+jywb4jMumXWsFEXZOtitiNtGIZhGEbB4PRZNwF4uShuRmRMKsorE9pazim6jlKVyrXRWSET0X/qX95nYla70B5JwzAMwzAKierFrcPcCM+Lsm0RKc/fd7vll9w8/Oh/FcPdjF/SWidCbYhM+lfEcQ65YUjV8qwu7OxxNAzDMAyjkGgaPqoN9Aygo3juSs6KOl1/rW5bWPBuK9VtrZeHTESvd1w9LdsiGmxH2jAMwzCMAmV8W+t3BH5bbHpGRR7B6Zo4e7cxywquT5YsvFRErwlRn7gifLtp6KjmQJY/9hgahmEYhlGwYnppyxWi8vMivLV1qpLYeYU0JKqqusOv/lUmLF1UBxoPmVlTZ+8+cnpQ1zchbRiGYRhGQTOhrTUJxIr09l51kMk3DhvZGlYDe6JzzAK+Eya7RHR609DRUwOtwx4/wzAMwzAKGlWZsHTh9cDFRXyXD2ik+8dhc/e4aHHLPurInQr7hWxQzJk1dNR4RDTIWuywoWEYhmEYhY2I7jT0yR+C/LaI7/JkSUVfHb+05afVbQsG5duYxKJF0fFtrTWuIy+GTkQrt+009KkJQYtosB1pwzAMwzCKhMSiRdF3dnFvVvhekd/qRyjJVHfFjDl7jVid68rHL205SlR+CRwQvkWV3vrxkA9/0CzjUjmpzh47wzAMwzCKRkxrwlm59OjrQS8qgdv9CLglJXLjnKEjXw9cQC9bdJi47lTg9HBqSL1+p6FPTUpIws2ZbrdHzjAMwzCMoiKkESSCvGPgMVW5w4lG5zXtdvS72brwue/N71exJnIyIhMFjg5vE8i0WcNGXpbzWu1pMwzDMAyjGKle0jJVRa4uMb3jAn8Ama/wvNMtLzTtWfW+t0VI63AVDhGVU4GTgL7hvl+9dNaw0cm8yHd7zAzDMAzDKFoxvbR1rCq3ApWl2wqyDOFNcN9SV1aI0ONXrV0iiKqzo6BfUpGdUf0aMKhAbmy9It+bPWzk3XlrWXvEDMMwDMMoZiYsaT0C4T5gO2uNouGf4sipTUNGPp9PIyz8nWEYhmEYRc2s3Uc9063dXwdesNYoCv4UcZxD8y2iTUgbhmEYhlES3Lz7mBWVbsfRqsy21ihglNv6l/cZccOQquVhMMdcOwzDMAzDKCmql7RcpCKNlLTfdMGxDmTSrGEj54TJKBPShmEYhmGUHOOXL9hbUnI7yFetNcKNwF/B/W7TsGNfCZtt5tphGIZhGEbJMXu3Y/9e6XYeBlxDOmScET5URa+tcDsODqOI7hH5hmEYhmEYpcuEtpbRInKjKkOtNULDElGtbtp99KIwG2k70oZhGIZhlDSzho1u6VfWZz/Su9Pd1iJ5pVtFr93Qr/urYRfRYDvShmEYhmEY/2b8koUHieivgG9Ya+Sc53Gci2cNqfpzoRhsQtowDMMwDOOzqEr1soXfUqUO2MUaJOj25h1Frtp52BOzE5IoKH91E9KGYRiGYRgbYeKri/p3VaauAKkB+liLZJ11qjR09O/+xW07jFlbiDdgQtowDMMwDGMzXLD4ie2jTlctMBmLPZ0NOkX0lu6oe9WcXY57p5BvxIS0YRiGYRhGbwT1kvmDy5zIf6vKeUCFtYhnOhTm4Dr/N3t41dvFcEMmpA3DMAzDMDxw8ZL5X3IlOtEVfiTKttYiW6RdRW+Jdsm0G/YctbKYbsyEtGEYhmEYhg8mvrqof3eF/gDRiQp7Wot8gddQrt/Qv3tOofpAm5A2DMMwDMMImPFLFh7kOG61qpwD9CvhptgAzANtmjV0VCsiWsw3a0LaMAzDMAwjS5y/bNFW0ZSOQ3ScwDeBSAncdgpkkYje2SnOXbcMqfq4VPrbhLRhGIZhGEYAjF/a8mVR5yzQs4ARQHkR3V6nwpMO/N7R7t/fsPuYf5ZiH5uQNgzDMAzDCJiJry7q31muo8ThBNAxwG4FKBuXgc5H5OGy9bLw+n2r1pR6v5qQNgzDMAzDyDEXLJk/OCLREaIcgegIkP2AaIhM7BbhFXV5GvRp1chTxRKyzoS0YRiGYRhGEXH+skWV5d3uPoju7yL7i7A/MAwYTLAuIZ3AW8BSVV5x0FdQeaWCjldnDj+xw3rGhLRhGIZhGEZBMlbnRrZeuvVOIs5urupgUWdbFbYV2FbRbVH6ItI3/WsdSPpwYwqkPf1Xug5hnSAfKHwgygcq7geOyIpOt3vZrsOeXZmQhGst7Y//D6k+Kw4kEUk3AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTA2LTIyVDEwOjIxOjEyKzAwOjAw7+lpewAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wNi0yMlQxMDoyMToxMiswMDowMJ600ccAAAAASUVORK5CYII="; // Logo em base64

    // Ajuste de tamanho da logo para um tamanho adequado (exemplo: 50px de largura)
    doc.addImage(logoBase64, "PNG", 10, 10, 50, 25); // 50px de largura e 25px de altura

    // Adicionando um título ao PDF
    doc.text("Relatório de Métricas", 70, 20);

    // Definindo os dados da tabela
    const tableData = validMetrics.map((metric) => [
      metric.name,
      metric.department,
      metric.enps,
      metric.satisfactionScore,
      metric.retentionRate,
      metric.turnoverRate,
      metric.onboardingTime,
      metric.absenteeismRate,
      metric.engagementScore,
    ]);

    // Cabeçalhos da tabela
    const tableHeaders = [
      "Name",
      "Department",
      "eNPS",
      "Satisfaction",
      "Retention",
      "Turnover",
      "Onboarding",
      "Absenteeism",
      "Engagement",
    ];

    // Criando a tabela com autoTable
    autoTable(doc, {
      startY: 40, 
      head: [tableHeaders],
      body: tableData,
      theme: "grid", 
      headStyles: { fillColor: [22, 160, 133] },
      alternateRowStyles: { fillColor: [245, 245, 245] },
      styles: { cellPadding: 5 },
    });

    // Salvando o arquivo PDF
    doc.save("relatorio.pdf");
  };

  const handleExportCSV = () => {
    console.log("Exportar como CSV clicado");

    // Filtrando as métricas válidas
    const validMetrics = filterValidMetrics(metrics);

    // Cabeçalho das colunas do CSV
    const headers = [
      "Name",
      "Department",
      "eNPS",
      "Satisfaction",
      "Retention",
      "Turnover",
      "Onboarding",
      "Absenteeism",
      "Engagement"
    ];

    // Estruturando os dados com base nos atributos das métricas
    const data = validMetrics.map((metric) => ({
      Name: metric?.name || "N/A",
      Department: metric?.department || "N/A",
      eNPS: metric?.enps ?? "N/A",
      Satisfaction: metric?.satisfactionScore ?? "N/A",
      Retention: metric?.retentionRate ?? "N/A",
      Turnover: metric?.turnoverRate ?? "N/A",
      Onboarding: metric?.onboardingTime ?? "N/A",
      Absenteeism: metric?.absenteeismRate ?? "N/A",
      Engagement: metric?.engagementScore ?? "N/A"
    }));

    // Gerando o CSV com o PapaParse
    const csv = Papa.unparse({
      fields: headers,
      data: data,
    });

    // Criando o arquivo CSV
    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.href = url;
    link.download = "dados.csv";
    link.click();
  };

  return (
    <div style={{ marginBottom: "20px" }}>
      <Button onClick={handleExportPDF} variant="contained" color="primary">
        Exportar para PDF
      </Button>
      <Button onClick={handleExportCSV} variant="contained" color="secondary" style={{ marginLeft: "10px" }}>
        Exportar para CSV
      </Button>
    </div>
  );
};

export default ExportButtons;
